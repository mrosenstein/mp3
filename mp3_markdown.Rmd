---
title: 'Mini Project #3'
author: "Mae Rosenstein, Talia Seshaiah and Olivia Baldwin"
date: "4/15/2018"
output: 
  html_document: 
    code_folding: hide
---
```{r setup}
install.packages("macleish")
library(tidyverse)
library(macleish)
library(lubridate)
library(dplyr)
load("maple_sap.rda")
library(sf) # done and done
library(devtools)
```

```{r}
# Live weather data 
mac <- etl("macleish") %>%
 etl_update()
whately <- mac %>%
 tbl("whately") %>%
 collect(n = Inf)

```


```{r}
# Selecting important parts of weather data
weather_info <- whately %>%
  select(when, temperature, pressure)

glimpse(weather_info)

# Changing the date format of the weather_info dataset 
weather_info2 <- whately %>%
mutate(date2 = as_date(when)) 
glimpse(weather_info2)
```

```{r}
# Changing the date format of the weather_info dataset 
date <- formatdate(yyyy-mm-dd)
as.interval(date, ymd())
glimpse(weather_info)

# Joining pressure and tempature from weather data with maple sap data
 maple_sap_select <- maple_sap %>% 
  select(when, sap) 
  View(maple_sap_select)

weather_info_select <- weather_info2 %>%
  select(date2, temperature, pressure) %>%
  rename(when = date2) 
View(weather_info_select)

full_dataset <- full_join(maple_sap_select, weather_info_select, by = "when", copy = TRUE) %>%
  #filter(!is.na(temperature)) %>%
  #filter(!is.na(sap))
  #filter(!is.na(pressure))
View(full_dataset)

```

```{r}
library(sf)
library(leaflet)


#creating a leaflet map with the other sugar houses

my_points <- tribble(
  ~point, ~lat, ~lon, ~geometry,
  "Dufresne's Sugarhouse", 42.415240, -72.761856, "POINT",
  "Brookledge Sugarhouse", 42.428837, -72.662263, "POINT",
  "North Hadley Sugar Shack", 42.379097, -72.584417,"POINT",
  "Zawalick's Sugar House", 42.327841, -72.721173, "POINT", 
  "Hanging Mountain Farm", 42.323968, -72.754591, "POINT", 
  "Steve's Sugar Shack", 42.307773, -72.771403, "POINT",
  "Mayval Farm", 42.300522, -72.744081, "POINT"
)

maplehouse <- my_points %>%
  st_as_sf(coords = c("lat", "lon"))

st_combine(maplehouse)
plot(st_union(maplehouse))

leaflet() %>%
  addTiles() %>%
  addMarkers(data = my_points, popup = ~point)


```

















```{r}
#macleish map with forests and landmarks

library(leaflet)

macleish_layers[["forests"]]
class(macleish_layers[["landmarks"]])

leaflet() %>%
  addTiles() %>%
  addMarkers(data = )

```

[^1]: GitHub repository

[^https://github.com/mrosenstein/mp3]






